<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HARAYA Cultural Intelligence & Scam Detection Demo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        .demo-section {
            background: white;
            border-radius: 16px;
            padding: 2rem;
            margin: 1rem 0;
            box-shadow: 0 8px 30px rgba(0,0,0,0.08);
        }
    </style>
</head>
<body class="bg-gray-50">
    <div class="container mx-auto p-6">
        <h1 class="text-4xl font-bold text-center mb-8 text-blue-800">
            üáµüá≠ HARAYA Cultural Intelligence & Scam Detection Demo
        </h1>
        
        <!-- Cultural Intelligence Demo -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-6 text-green-700">ü§ù Cultural Intelligence System</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Adaptive Cultural Weights</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Kapwa (Shared Identity): <span id="kapwaWeight">30%</span></label>
                            <input type="range" id="kapwaSlider" min="10" max="50" value="30" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Bayanihan (Community Spirit): <span id="bayanihanWeight">25%</span></label>
                            <input type="range" id="bayanihanSlider" min="10" max="50" value="25" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Utang na Loob (Gratitude): <span id="utangWeight">25%</span></label>
                            <input type="range" id="utangSlider" min="10" max="50" value="25" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Traditional Values: <span id="traditionalWeight">20%</span></label>
                            <input type="range" id="traditionalSlider" min="5" max="40" value="20" class="w-full">
                        </div>
                    </div>
                    
                    <div class="mt-4">
                        <label class="block text-sm font-medium mb-2">Regional Context</label>
                        <select id="regionalContext" class="w-full p-2 border rounded">
                            <option value="luzon_metro">Metro Manila</option>
                            <option value="luzon_rural">Luzon Rural</option>
                            <option value="visayas_urban">Visayas Urban</option>
                            <option value="visayas_rural">Visayas Rural</option>
                            <option value="mindanao_urban">Mindanao Urban</option>
                            <option value="mindanao_rural">Mindanao Rural</option>
                        </select>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Cultural Analysis Results</h3>
                    <canvas id="culturalChart" width="400" height="300"></canvas>
                    
                    <div class="mt-4 grid grid-cols-3 gap-4 text-center">
                        <div class="bg-blue-50 p-3 rounded">
                            <div class="text-2xl font-bold text-blue-600" id="authenticityScore">85%</div>
                            <div class="text-sm text-gray-600">Authenticity</div>
                        </div>
                        <div class="bg-green-50 p-3 rounded">
                            <div class="text-2xl font-bold text-green-600" id="regionalScore">78%</div>
                            <div class="text-sm text-gray-600">Regional Fit</div>
                        </div>
                        <div class="bg-purple-50 p-3 rounded">
                            <div class="text-2xl font-bold text-purple-600" id="communityScore">92%</div>
                            <div class="text-sm text-gray-600">Community</div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-6">
                <h4 class="text-md font-semibold mb-2">Cultural Insights</h4>
                <div id="culturalInsights" class="bg-gray-50 p-4 rounded text-sm">
                    Analyzing cultural patterns...
                </div>
            </div>
        </div>
        
        <!-- Scam Detection Demo -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-6 text-red-700">üõ°Ô∏è Scam Detection System</h2>
            
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-6">
                <div>
                    <h3 class="text-lg font-semibold mb-4">Test Persona Controls</h3>
                    <div class="space-y-4">
                        <div>
                            <label class="block text-sm font-medium mb-1">Monthly Income (‚Ç±)</label>
                            <input type="number" id="testIncome" value="25000" class="w-full p-2 border rounded">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Community Standing: <span id="communitystandingValue">0.85</span></label>
                            <input type="range" id="testCommunityStanding" min="0" max="1" step="0.01" value="0.85" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Digital Activity Level: <span id="digitalactivityValue">6</span></label>
                            <input type="range" id="testDigitalActivity" min="1" max="10" value="6" class="w-full">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Transaction Velocity</label>
                            <input type="number" id="testTransactionVelocity" value="15" class="w-full p-2 border rounded">
                        </div>
                        <div>
                            <label class="block text-sm font-medium mb-1">Region</label>
                            <select id="testRegion" class="w-full p-2 border rounded">
                                <option value="luzon_metro">Metro Manila</option>
                                <option value="luzon_rural">Luzon Rural</option>
                                <option value="visayas_urban">Visayas Urban</option>
                                <option value="mindanao_rural">Mindanao Rural</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="mt-6 grid grid-cols-2 gap-3">
                        <button onclick="generateLegitimateExample()" class="bg-green-500 text-white px-4 py-2 rounded hover:bg-green-600">
                            Generate Legitimate
                        </button>
                        <button onclick="generateAdversarialExample()" class="bg-red-500 text-white px-4 py-2 rounded hover:bg-red-600">
                            Generate Scammer
                        </button>
                    </div>
                </div>
                
                <div>
                    <h3 class="text-lg font-semibold mb-4">Risk Analysis</h3>
                    <div class="mb-4 p-4 border rounded" id="riskAnalysisResult">
                        <div class="flex items-center justify-between mb-2">
                            <span class="font-medium">Risk Level:</span>
                            <span id="riskLevel" class="px-3 py-1 rounded-full text-white bg-green-500">LOW RISK</span>
                        </div>
                        <div class="text-sm text-gray-600" id="riskExplanation">
                            Profile shows authentic Filipino cultural patterns with consistent community engagement.
                        </div>
                    </div>
                    
                    <canvas id="behaviorChart" width="400" height="300"></canvas>
                    
                    <div class="mt-4 grid grid-cols-3 gap-2 text-xs">
                        <div class="bg-blue-50 p-2 rounded text-center">
                            <div class="font-medium">Cultural</div>
                            <div id="scamAuthenticity" class="font-bold text-green-600">High</div>
                        </div>
                        <div class="bg-yellow-50 p-2 rounded text-center">
                            <div class="font-medium">Transactions</div>
                            <div id="scamTransactionPattern" class="font-bold text-blue-600">Normal</div>
                        </div>
                        <div class="bg-green-50 p-2 rounded text-center">
                            <div class="font-medium">Community</div>
                            <div id="scamCommunityValidation" class="font-bold text-green-600">Strong</div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Demo Data Section -->
        <div class="demo-section">
            <h2 class="text-2xl font-bold mb-6 text-gray-700">üìä Demo with Real Data</h2>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <button onclick="loadSampleData('legitimate')" class="p-4 bg-green-50 border border-green-200 rounded hover:bg-green-100">
                    <div class="font-semibold text-green-700">Load Legitimate Profiles</div>
                    <div class="text-sm text-gray-600">144 authentic Filipino personas</div>
                </button>
                <button onclick="loadSampleData('scammer')" class="p-4 bg-red-50 border border-red-200 rounded hover:bg-red-100">
                    <div class="font-semibold text-red-700">Load Scammer Profiles</div>
                    <div class="text-sm text-gray-600">60 fraudulent patterns</div>
                </button>
                <button onclick="loadSampleData('mixed')" class="p-4 bg-blue-50 border border-blue-200 rounded hover:bg-blue-100">
                    <div class="font-semibold text-blue-700">Load Mixed Dataset</div>
                    <div class="text-sm text-gray-600">All 204 profiles</div>
                </button>
            </div>
            
            <div id="dataStats" class="mt-4 p-4 bg-gray-50 rounded text-sm">
                Click a button above to load demo data and see the cultural intelligence system in action.
            </div>
        </div>
    </div>

    <script>
        // Mock ML Core for standalone demo
        const mlCore = {
            sharedData: null
        };

        // Cultural Intelligence State
        const culturalIntelligenceState = {
            weights: { kapwa: 30, bayanihan: 25, utang: 25, traditional: 20 },
            regionalContext: 'luzon_metro',
            regionalProfiles: {
                'luzon_metro': { kapwa: 0.65, bayanihan: 0.60, utang: 0.75, traditional: 0.4 },
                'luzon_rural': { kapwa: 0.80, bayanihan: 0.85, utang: 0.85, traditional: 0.8 },
                'visayas_urban': { kapwa: 0.75, bayanihan: 0.80, utang: 0.80, traditional: 0.6 },
                'visayas_rural': { kapwa: 0.85, bayanihan: 0.90, utang: 0.88, traditional: 0.9 },
                'mindanao_urban': { kapwa: 0.70, bayanihan: 0.75, utang: 0.78, traditional: 0.5 },
                'mindanao_rural': { kapwa: 0.88, bayanihan: 0.92, utang: 0.90, traditional: 0.95 }
            }
        };

        // Scam Detection State
        const scamDetectionState = {
            testPersona: {
                monthly_income: 25000,
                community_standing_score: 0.85,
                digital_activity_level: 6,
                transaction_velocity: 15,
                regional_context: 'luzon_metro'
            }
        };

        let culturalChart = null;
        let behaviorChart = null;

        // Initialize charts
        function initializeCharts() {
            // Cultural Intelligence Chart
            const culturalCtx = document.getElementById('culturalChart').getContext('2d');
            culturalChart = new Chart(culturalCtx, {
                type: 'radar',
                data: {
                    labels: ['Kapwa\n(Shared Identity)', 'Bayanihan\n(Community Spirit)', 'Utang na Loob\n(Gratitude)', 'Traditional\nValues'],
                    datasets: [{
                        label: 'Current Weights',
                        data: [30, 25, 25, 20],
                        borderColor: '#0057A6',
                        backgroundColor: 'rgba(0, 87, 166, 0.2)',
                        borderWidth: 2
                    }, {
                        label: 'Regional Baseline',
                        data: [65, 60, 75, 40],
                        borderColor: '#FCD116',
                        backgroundColor: 'rgba(252, 209, 22, 0.2)',
                        borderWidth: 2
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });

            // Behavior Pattern Chart
            const behaviorCtx = document.getElementById('behaviorChart').getContext('2d');
            behaviorChart = new Chart(behaviorCtx, {
                type: 'radar',
                data: {
                    labels: ['Income\nConsistency', 'Community\nValidation', 'Digital\nBehavior', 'Transaction\nPattern'],
                    datasets: [{
                        label: 'Current Profile',
                        data: [80, 85, 75, 80],
                        borderColor: '#10B981',
                        backgroundColor: 'rgba(16, 185, 129, 0.2)',
                        borderWidth: 2
                    }, {
                        label: 'Legitimate Baseline',
                        data: [80, 90, 85, 80],
                        borderColor: '#6B7280',
                        backgroundColor: 'rgba(107, 114, 128, 0.1)',
                        borderWidth: 1,
                        borderDash: [5, 5]
                    }]
                },
                options: {
                    responsive: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100
                        }
                    }
                }
            });
        }

        // Update cultural weights
        function updateCulturalWeights() {
            const sliders = ['kapwa', 'bayanihan', 'utang', 'traditional'];
            let total = 0;

            sliders.forEach(slider => {
                const value = parseInt(document.getElementById(slider + 'Slider').value);
                culturalIntelligenceState.weights[slider] = value;
                total += value;
            });

            // Normalize to 100%
            if (total !== 100) {
                const factor = 100 / total;
                sliders.forEach(slider => {
                    culturalIntelligenceState.weights[slider] = Math.round(culturalIntelligenceState.weights[slider] * factor);
                    document.getElementById(slider + 'Slider').value = culturalIntelligenceState.weights[slider];
                });
            }

            // Update displays
            sliders.forEach(slider => {
                document.getElementById(slider + 'Weight').textContent = culturalIntelligenceState.weights[slider] + '%';
            });

            // Update regional context
            culturalIntelligenceState.regionalContext = document.getElementById('regionalContext').value;

            // Update chart
            updateCulturalChart();
            updateCulturalInsights();
        }

        function updateCulturalChart() {
            const weights = culturalIntelligenceState.weights;
            const regional = culturalIntelligenceState.regionalProfiles[culturalIntelligenceState.regionalContext];

            culturalChart.data.datasets[0].data = [weights.kapwa, weights.bayanihan, weights.utang, weights.traditional];
            culturalChart.data.datasets[1].data = [regional.kapwa * 100, regional.bayanihan * 100, regional.utang * 100, regional.traditional * 100];
            culturalChart.update();

            // Update scores (simulated)
            const authenticity = 85 + Math.random() * 10;
            const regional_fit = 75 + Math.random() * 15;
            const community = 88 + Math.random() * 12;

            document.getElementById('authenticityScore').textContent = Math.round(authenticity) + '%';
            document.getElementById('regionalScore').textContent = Math.round(regional_fit) + '%';
            document.getElementById('communityScore').textContent = Math.round(community) + '%';
        }

        function updateCulturalInsights() {
            const weights = culturalIntelligenceState.weights;
            const region = culturalIntelligenceState.regionalContext;
            
            let insights = [];
            const maxWeight = Math.max(weights.kapwa, weights.bayanihan, weights.utang, weights.traditional);
            const maxKey = Object.keys(weights).find(key => weights[key] === maxWeight);
            
            if (maxKey === 'kapwa') {
                insights.push(`Kapwa-centric model (${weights.kapwa}%) emphasizes shared identity - ideal for community-based lending`);
            } else if (maxKey === 'bayanihan') {
                insights.push(`Bayanihan-focused model (${weights.bayanihan}%) prioritizes collective action - strong for group lending`);
            }
            
            if (region.includes('rural')) {
                insights.push('Rural context: Expects stronger traditional values and community ties');
            } else if (region.includes('metro')) {
                insights.push('Metro context: Allows for individualized and modernized patterns');
            }
            
            document.getElementById('culturalInsights').innerHTML = insights.join('<br>‚Ä¢ ');
        }

        // Scam detection functions
        function analyzeScamRisk() {
            // Update persona from controls
            scamDetectionState.testPersona.monthly_income = parseInt(document.getElementById('testIncome').value);
            scamDetectionState.testPersona.community_standing_score = parseFloat(document.getElementById('testCommunityStanding').value);
            scamDetectionState.testPersona.digital_activity_level = parseInt(document.getElementById('testDigitalActivity').value);
            scamDetectionState.testPersona.transaction_velocity = parseInt(document.getElementById('testTransactionVelocity').value);
            scamDetectionState.testPersona.regional_context = document.getElementById('testRegion').value;

            // Update displays
            document.getElementById('communitystandingValue').textContent = scamDetectionState.testPersona.community_standing_score.toFixed(2);
            document.getElementById('digitalactivityValue').textContent = scamDetectionState.testPersona.digital_activity_level;

            // Calculate risk score (simplified)
            let riskScore = 0;
            const persona = scamDetectionState.testPersona;

            // Income vs community standing mismatch
            if (persona.monthly_income > 50000 && persona.community_standing_score < 0.3) {
                riskScore += 0.4;
            }

            // High transaction velocity
            if (persona.transaction_velocity > 40) {
                riskScore += 0.3;
            }

            // Perfect scores suspicious
            if (persona.community_standing_score >= 0.95) {
                riskScore += 0.2;
            }

            // Regional income inconsistency
            const expectedIncome = {
                'luzon_metro': 30000, 'luzon_rural': 15000,
                'visayas_urban': 22000, 'mindanao_rural': 12000
            }[persona.regional_context] || 25000;

            if (persona.monthly_income > expectedIncome * 2.5) {
                riskScore += 0.3;
            }

            // Update risk display
            let riskLevel, riskClass, explanation;
            if (riskScore < 0.3) {
                riskLevel = 'LOW RISK';
                riskClass = 'bg-green-500';
                explanation = 'Profile shows authentic Filipino cultural patterns with consistent community engagement.';
            } else if (riskScore < 0.7) {
                riskLevel = 'MEDIUM RISK';
                riskClass = 'bg-yellow-500';
                explanation = 'Some irregular patterns detected. Requires additional verification.';
            } else {
                riskLevel = 'HIGH RISK';
                riskClass = 'bg-red-500';
                explanation = 'Multiple suspicious indicators detected. High probability of fraudulent activity.';
            }

            document.getElementById('riskLevel').textContent = riskLevel;
            document.getElementById('riskLevel').className = `px-3 py-1 rounded-full text-white ${riskClass}`;
            document.getElementById('riskExplanation').textContent = explanation;

            // Update behavior chart
            const incomeScore = Math.max(0, 100 - riskScore * 100);
            const communityScore = persona.community_standing_score * 100;
            const digitalScore = Math.max(20, 100 - Math.abs(persona.digital_activity_level - 6) * 15);
            const transactionScore = Math.max(20, 100 - Math.max(0, persona.transaction_velocity - 25) * 3);

            behaviorChart.data.datasets[0].data = [incomeScore, communityScore, digitalScore, transactionScore];
            behaviorChart.data.datasets[0].borderColor = riskLevel === 'LOW RISK' ? '#10B981' : 
                                                        riskLevel === 'MEDIUM RISK' ? '#F59E0B' : '#EF4444';
            behaviorChart.data.datasets[0].backgroundColor = riskLevel === 'LOW RISK' ? 'rgba(16, 185, 129, 0.2)' : 
                                                           riskLevel === 'MEDIUM RISK' ? 'rgba(245, 158, 11, 0.2)' : 'rgba(239, 68, 68, 0.2)';
            behaviorChart.update();

            // Update indicators
            document.getElementById('scamAuthenticity').textContent = riskScore < 0.3 ? 'High' : riskScore < 0.6 ? 'Moderate' : 'Low';
            document.getElementById('scamTransactionPattern').textContent = persona.transaction_velocity > 30 ? 'High' : 'Normal';
            document.getElementById('scamCommunityValidation').textContent = persona.community_standing_score > 0.7 ? 'Strong' : 'Weak';
        }

        function generateLegitimateExample() {
            const patterns = [
                { income: 18000, community: 0.75, digital: 5, velocity: 12, region: 'luzon_rural' },
                { income: 32000, community: 0.68, digital: 7, velocity: 18, region: 'luzon_metro' },
                { income: 15000, community: 0.85, digital: 4, velocity: 10, region: 'visayas_rural' }
            ];
            
            const pattern = patterns[Math.floor(Math.random() * patterns.length)];
            
            document.getElementById('testIncome').value = pattern.income;
            document.getElementById('testCommunityStanding').value = pattern.community;
            document.getElementById('testDigitalActivity').value = pattern.digital;
            document.getElementById('testTransactionVelocity').value = pattern.velocity;
            document.getElementById('testRegion').value = pattern.region;
            
            analyzeScamRisk();
        }

        function generateAdversarialExample() {
            const scammerPatterns = [
                { income: 80000, community: 0.15, digital: 9, velocity: 60, region: 'luzon_rural' }, // Synthetic profile
                { income: 25000, community: 0.95, digital: 8, velocity: 45, region: 'mindanao_rural' }, // Cultural mimic
                { income: 8000, community: 0.3, digital: 2, velocity: 80, region: 'visayas_urban' } // Money mule
            ];
            
            const pattern = scammerPatterns[Math.floor(Math.random() * scammerPatterns.length)];
            
            document.getElementById('testIncome').value = pattern.income;
            document.getElementById('testCommunityStanding').value = pattern.community;
            document.getElementById('testDigitalActivity').value = pattern.digital;
            document.getElementById('testTransactionVelocity').value = pattern.velocity;
            document.getElementById('testRegion').value = pattern.region;
            
            analyzeScamRisk();
        }

        function loadSampleData(type) {
            const stats = document.getElementById('dataStats');
            
            if (type === 'legitimate') {
                stats.innerHTML = `
                    <h4 class="font-semibold text-green-700 mb-2">Legitimate Profiles Loaded (144 samples)</h4>
                    <p class="text-sm">‚Ä¢ Average income: ‚Ç±23,500 | Age range: 19-65</p>
                    <p class="text-sm">‚Ä¢ High community standing (avg: 0.78) | Strong cultural authenticity</p>
                    <p class="text-sm">‚Ä¢ Normal transaction patterns | Consistent regional income alignment</p>
                `;
            } else if (type === 'scammer') {
                stats.innerHTML = `
                    <h4 class="font-semibold text-red-700 mb-2">Scammer Profiles Loaded (60 samples)</h4>
                    <p class="text-sm">‚Ä¢ Income inconsistencies detected | Suspicious transaction velocities</p>
                    <p class="text-sm">‚Ä¢ Low community ties (avg: 0.32) | Cultural pattern mismatches</p>
                    <p class="text-sm">‚Ä¢ Multiple behavioral anomalies | High risk indicators</p>
                `;
            } else {
                stats.innerHTML = `
                    <h4 class="font-semibold text-blue-700 mb-2">Mixed Dataset Loaded (204 samples)</h4>
                    <p class="text-sm">‚Ä¢ 144 legitimate profiles, 60 scammer patterns</p>
                    <p class="text-sm">‚Ä¢ 6 regional contexts represented | Full cultural spectrum</p>
                    <p class="text-sm">‚Ä¢ Ready for comprehensive cultural intelligence analysis</p>
                `;
            }
            
            // Simulate updating cultural scores
            setTimeout(() => {
                const authenticity = type === 'scammer' ? 45 + Math.random() * 20 : 75 + Math.random() * 20;
                const regional = type === 'scammer' ? 35 + Math.random() * 25 : 70 + Math.random() * 25;
                const community = type === 'scammer' ? 30 + Math.random() * 30 : 80 + Math.random() * 15;
                
                document.getElementById('authenticityScore').textContent = Math.round(authenticity) + '%';
                document.getElementById('regionalScore').textContent = Math.round(regional) + '%';
                document.getElementById('communityScore').textContent = Math.round(community) + '%';
            }, 500);
        }

        // Event listeners
        document.addEventListener('DOMContentLoaded', function() {
            initializeCharts();
            
            // Cultural intelligence sliders
            ['kapwa', 'bayanihan', 'utang', 'traditional'].forEach(slider => {
                document.getElementById(slider + 'Slider').addEventListener('input', updateCulturalWeights);
            });
            
            document.getElementById('regionalContext').addEventListener('change', updateCulturalWeights);
            
            // Scam detection controls
            ['testIncome', 'testCommunityStanding', 'testDigitalActivity', 'testTransactionVelocity', 'testRegion'].forEach(control => {
                const element = document.getElementById(control);
                if (element) {
                    element.addEventListener('input', analyzeScamRisk);
                    element.addEventListener('change', analyzeScamRisk);
                }
            });
            
            // Initial analysis
            updateCulturalWeights();
            analyzeScamRisk();
        });
    </script>
</body>
</html>